# Story 2.2: Edit Vehicle Details

## Status
ðŸ”„ **IN PROGRESS** - Ready for development

## Story
**As a** driver,
**I want** to be able to edit the details of a car in my garage,
**so that** I can keep my vehicle information up to date.

## Acceptance Criteria
- [ ] 1. Tapping a vehicle navigates to an edit screen
- [ ] 2. The user can modify and save changes
- [ ] 3. Saving updates the vehicle document in Firestore
- [ ] 4. Updates are reflected in the "My Garage" list

## Tasks / Subtasks
- [ ] Task 1: Create Edit Vehicle Screen (AC: 1, 2)
  - [ ] Create EditVehicleScreen component
  - [ ] Pre-populate form with existing vehicle data
  - [ ] Implement form validation for edited fields
  - [ ] Add save and cancel buttons with proper styling
  - [ ] Handle loading states during data fetching
- [ ] Task 2: Implement Vehicle Update Service (AC: 3)
  - [ ] Add updateVehicle() function to vehicle service
  - [ ] Implement optimistic updates for better UX
  - [ ] Add proper error handling for update failures
  - [ ] Ensure offline support for vehicle updates
  - [ ] Add validation before saving changes
- [ ] Task 3: Navigation & Routing (AC: 1, 4)
  - [ ] Add edit vehicle route to navigation structure
  - [ ] Implement navigation from garage list to edit screen
  - [ ] Pass vehicle data as navigation parameters
  - [ ] Add proper back navigation and form cancellation
  - [ ] Handle navigation state management
- [ ] Task 4: Form Reusability & Components (AC: 2)
  - [ ] Refactor vehicle form to be reusable (create/edit)
  - [ ] Implement form mode switching (create vs edit)
  - [ ] Add field-level validation and error display
  - [ ] Implement form state management
  - [ ] Add confirmation dialog for unsaved changes
- [ ] Task 5: Real-time Updates & Synchronization (AC: 4)
  - [ ] Implement real-time listeners for vehicle updates
  - [ ] Update garage list when vehicle is modified
  - [ ] Handle concurrent edit scenarios
  - [ ] Add conflict resolution for simultaneous edits
  - [ ] Ensure data consistency across screens
- [ ] Task 6: Testing (Testing Standards)
  - [ ] Write unit tests for vehicle update service
  - [ ] Test edit vehicle form validation and submission
  - [ ] Test navigation flows between garage and edit screens
  - [ ] Test real-time update scenarios
  - [ ] Test offline functionality for vehicle edits
  - [ ] Integration tests with Firestore emulator

## Dev Notes
- Reuse vehicle form component from Story 2.1 for consistency
- Implement optimistic updates to improve perceived performance
- Consider implementing vehicle deletion functionality (future enhancement)
- Add confirmation for significant vehicle changes
- Handle edge cases like vehicle being deleted while editing
- Consider implementing change history for vehicle modifications

## Testing Strategy
- Unit test vehicle update service methods
- Test form validation and submission flows
- Test navigation between garage and edit screens
- Test real-time update scenarios with multiple users
- Test offline functionality and data synchronization
- Manual testing on iOS and Android devices
- Test form state management and unsaved changes handling

## Dev Agent Record

### Agent Model Used
*To be updated during implementation*

### Debug Log References
*To be updated as implementation progresses*

### Completion Notes List
*To be updated as tasks are completed*

### File List
**Planned Files:**
- `src/screens/EditVehicleScreen.tsx` - Vehicle editing screen
- `src/components/VehicleForm.tsx` - Reusable vehicle form component
- `src/components/ConfirmDialog.tsx` - Confirmation dialog component
- `__tests__/EditVehicleScreen.test.tsx` - Edit vehicle screen tests
- `__tests__/VehicleForm.test.tsx` - Vehicle form component tests

**Modified Files:**
- `src/screens/GarageScreen.tsx` - Add navigation to edit screen
- `src/services/vehicles.ts` - Add updateVehicle function
- `src/navigation/AppNavigator.tsx` - Add edit vehicle route
- `src/components/VehicleCard.tsx` - Add edit button/tap handler

## QA Results
*QA testing results will be documented here*

## Change Log
| Date | Changes | Author |
| :--- | :--- | :--- |
| 2025-01-27 | Story created | SM Agent |
