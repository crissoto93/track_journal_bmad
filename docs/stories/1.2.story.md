# Story 1.2: Email/Password Sign-up

## Status
Draft

## Story
**As a** new user,
**I want** to be able to sign up for an account using my email and a password,
**so that** I can create my personal Track Journal account.

## Acceptance Criteria
1. A sign-up screen is created
2. Input validation is present
3. "Sign Up" creates a user in Firebase Auth
4. A user document is created in Firestore
5. The user is navigated to the dashboard on success
6. Clear error messages are shown on failure

## Tasks / Subtasks
- [ ] Task 1: Implement Sign-up UI (AC: 1, 2, 6)
  - [ ] Create `SignUpScreen` in `src/screens/` with email and password inputs and a "Sign Up" button [Source: architecture/source-tree.md]
  - [ ] Add client-side validation (required, email format, min password length) and disable submit until valid [Source: architecture/components.md]
  - [ ] Display clear error messages for validation and backend failures (e.g., Snackbar/HelperText)

- [ ] Task 2: Add Auth Module sign-up function (AC: 3)
  - [ ] In `src/services/`, add an Auth service exposing `signUp(email, password)` that calls `createUserWithEmailAndPassword()` [Source: architecture/frontend-architecture.md; architecture/api-specification.md]
  - [ ] Return the created user UID and basic profile info on success

- [ ] Task 3: Create User Profile in Firestore (AC: 4)
  - [ ] In `src/services/`, add a Data Service function `createUserProfile(uid, data)` that writes to `users/{uid}` via `setDoc` with `email`, `createdAt` [Source: architecture/data-models.md; architecture/api-specification.md]
  - [ ] Ensure the write path conforms to security rules expectations (user writes only their own doc) [Source: architecture/backend-architecture.md]

- [ ] Task 4: Navigation to Dashboard (AC: 5)
  - [ ] On successful sign-up + profile creation, navigate to the main App stack (Dashboard) using React Navigation [Source: architecture/frontend-architecture.md]
  - [ ] Ensure Auth and App stacks are conditionally rendered based on auth state in `src/navigation/` [Source: architecture/frontend-architecture.md]

- [ ] Task 5: Error Handling & UX (AC: 6)
  - [ ] Surface specific auth and Firestore errors (e.g., email in use, weak password, network) in the UI [Source: architecture/api-specification.md]
  - [ ] Provide retry guidance and keep inputs intact after errors

- [ ] Task 6: Testing
  - [ ] Unit test Auth service `signUp` behavior with Firebase Local Emulator Suite [Source: architecture/development-workflow-cicd-testing.md]
  - [ ] Unit test Data Service `createUserProfile` success and failure paths (emulator) [Source: architecture/development-workflow-cicd-testing.md]
  - [ ] Integration test: sign-up flow happy path (mock UI) to ensure navigation to Dashboard on success [Source: architecture/development-workflow-cicd-testing.md]

## Dev Notes

### Previous Story Insights
- Project structure created under `src/` with `components/`, `navigation/`, `screens/`, `services/`, `types/` [From: `docs/stories/1.1.story.md`]
- Firebase initialization implemented and verified on startup [From: `docs/stories/1.1.story.md`]

### Data Models
- User document lives at `users/{userId}` with fields including `id`, `name`, `email`, `createdAt` [Source: architecture/data-models.md]

### API Specifications
- Authentication uses Firebase Auth SDK `createUserWithEmailAndPassword(email, password)` to create a user and return a UID [Source: architecture/api-specification.md]
- User profile creation uses Firestore `setDoc` to `users/{uid}` via the Data Service [Source: architecture/api-specification.md]

### Component Specifications
- Frontend Authentication Module manages sign-up and log-in flows [Source: architecture/components.md]
- UI interacts with services in `src/services/` (Repository pattern) rather than calling Firebase directly [Source: architecture/frontend-architecture.md]

### File Locations
- Screens in `src/screens/` (e.g., `SignUpScreen`) [Source: architecture/source-tree.md]
- Navigation in `src/navigation/` with separate stacks for Auth vs App [Source: architecture/frontend-architecture.md]
- Services in `src/services/` (e.g., Auth service and Data Service functions) [Source: architecture/frontend-architecture.md]

### Core Workflow Alignment
- Follow the "New User Sign-up" sequence: UI → Auth Module → Firebase Auth → Data Service → Firestore → Navigate to Dashboard [Source: architecture/core-workflows.md#workflow-1-new-user-sign-up]

### Testing Requirements
- Use Jest for unit/integration tests; use Firebase Local Emulator Suite for Auth/Firestore interactions [Source: architecture/development-workflow-cicd-testing.md]
- Manual E2E testing for MVP acceptable [Source: architecture/development-workflow-cicd-testing.md]

### Technical Constraints
- TypeScript (~5.9), React Native (~0.81), React Navigation; Firebase SDK (~11.x) [Source: architecture/tech-stack.md]
- Backend authorization enforced by Firestore Security Rules (user can access only their own data) [Source: architecture/backend-architecture.md]

### Project Structure Notes
- The above plan aligns with the unified project structure. No conflicts identified. [Source: architecture/source-tree.md]

## Change Log
| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| 2025-08-14 | 0.1 | Initial draft created from PRD and architecture | SM Agent |


